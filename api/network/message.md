# `message` Command

## Description

Insert a timestamped text message or a log event for a given entity and tags into the database.

Special fields supported by the message command:

* `type` - message type, used in the search index
* `source` - message source, used in the search index
* `severity` - criticality level, can be specified in [numeric or text format](#severity).

`type`, `source`, and `entity` fields are indexed and therefore provide fast response time for search queries.

The `severity` field is exposed in the rule engine for filtering and alerting.

## Syntax

```css
message e:{entity} t:type={type} t:source={source} t:severity={severity} t:{tag-name}={tag-value} m:{message} d:{time}
```

* If time fields are omitted, the record is inserted with the current server time.
* Message text or at least one tag is required, otherwise the message will be dropped silently.
* Entity name, tag names are case-insensitive and are converted to lower case when stored.
* Tag values and message text are case-sensitive and are stored as submitted.

```ls
# input command
message e:nurSWG t:Type=Security t:FS_type=NFS m:"Initiation complete"
# stored record
message e:nurswg t:type=Security t:fs_type=NFS m:"Initiation complete"
```

### Fields

| **Field** | **Type** | **Description** |
|:---|:---|:---|
| e         | string       | **[Required]** Entity name. |
| t         | string       | Tags, including reserved tags: `type`, `source`, [`severity`](../../api/data/severity.md). |
| m         | string       | Message text. |
| p         | boolean      | Persist message in the database. Default: true.<br>If disabled, the message is only processed by the rule-engine. |
| s         | integer      | Time in UNIX seconds. |
| ms        | integer      | Time in UNIX milliseconds. |
| d         | string       | Time in ISO format. |

### ABNF Syntax

Rules inherited from [Base ABNF](base-abnf.md).

```properties
  ; message or at least one tag is required
command = "message" MSP entity [MSP tag-type] [MSP tag-source] [MSP tag-severity] *(MSP tag) [MSP time] [MSP persist] [MSP message]
entity = "e:" NAME
tag-type = "t:type=" VALUE
tag-source = "t:source=" VALUE
  ; severity value is case-insensitive
  ; https://tools.ietf.org/html/rfc7405#section-2.1
tag-severity = "t:severity=" (%x30-37 / %i("UNDEFINED"/"UNKNOWN"/"NORMAL"/"WARNING"/"MINOR"/"MAJOR"/"CRITICAL"/"FATAL") )
tag = "t:" NAME "=" VALUE
message = "m:" VALUE
persist = "p:" ("true" / "false")
time = time-millisecond / time-second / time-iso
time-millisecond = "ms:" POSITIVE_INTEGER
time-second = "s:" POSITIVE_INTEGER
time-iso = "d:" ISO_DATE
```

## Limits

Refer to [limits](README.md#command-limits).

## Severity

In order for alerts generated by the rule engine to inherit message severity, set severity to 'unknown' on the Alerts tab in the Rule Engine editor.  

## Examples

```ls
message e:server001 t:type=application t:source=cron t:job="backup" m:"Task completed" d:2016-03-04T12:43:20Z
```

```ls
message e:server001 t:type=collector-job t:job_name=nginx-connect-check t:job_type=TCP t:status=COMPLETED
```

```ls
message e:server001 t:type=logger t:source=parsingstatistics t:level=ERROR s:1464076784
```
